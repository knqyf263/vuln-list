{
  "Identifier": "CVE-2021-27850",
  "PackageSlug": "maven/org.apache.tapestry/tapestry-core",
  "Title": "Deserialization of Untrusted Data",
  "Description": "A critical unauthenticated remote code execution vulnerability was found in Apache Tapestry. The vulnerability found is a bypass of the fix for CVE-2019-0195. Before the fix of CVE-2019-0195 it was possible to download arbitrary class files from the classpath by providing a crafted asset file URL. An attacker was able to download the file `AppModule.class` by requesting the URL `http://localhost:8080/assets/something/services/AppModule.class` which contains a HMAC secret key. The fix for that bug was an ignore filter that checks if the URL ends with `.class`, `.properties` or `.xml`. Unfortunately, the ignore list solution can simply be bypassed by appending a `/` at the end of the URL `http://localhost:8080/assets/something/services/AppModule.class/` The slash is stripped after the ignore list check and the file `AppModule.class` is loaded into the response. This class usually contains the HMAC secret key which is used to sign serialized Java objects. With the knowledge of that key an attacker can sign a Java gadget chain that leads to RCE (e.g. `CommonsBeanUtils1` from `ysoserial`).",
  "Date": "2021-04-22",
  "Pubdate": "2021-04-15",
  "AffectedRange": "[5.4.0,5.6.2),[5.7.0,5.7.1)",
  "FixedVersions": [
    "5.6.2",
    "5.7.1"
  ],
  "AffectedVersions": "All versions starting from 5.4.0 before 5.6.2, all versions starting from 5.7.0 before 5.7.1",
  "NotImpacted": "All versions before 5.4.0, all versions starting from 5.6.2 before 5.7.0, all versions starting from 5.7.1",
  "Solution": "Upgrade to versions 5.6.2, 5.7.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2021-27850",
    "https://lists.apache.org/thread.html/r237ff7f286bda31682c254550c1ebf92b0ec61329b32fbeb2d1c8751%40%3Cusers.tapestry.apache.org%3E"
  ],
  "CvssV2": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "f3f1f22b-7838-4d9d-8255-f614f40bd032"
}