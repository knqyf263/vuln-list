{
  "affected_release": [
    {
      "product_name": "Red Hat Satellite 6.8 for RHEL 7",
      "release_date": "2020-10-27T00:00:00Z",
      "advisory": "RHSA-2020:4366",
      "package": "tfm-rubygem-secure_headers-0:6.3.0-2.el7sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6"
    }
  ],
  "package_state": [
    {
      "product_name": "CloudForms Management Engine 5",
      "fix_state": "Will not fix",
      "package_name": "cfme-gemset",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2020-01-22T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2020-5217 rubygem-secure_headers: directive injection when using dynamic overrides with user input",
    "id": "1801264",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1801264"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-95-\u003eCWE-284",
  "statement": "Satellite 6 ships Secure Header rubygem, however it does not accept any user input in override_content_security_policy_directive or append_content_security_policy_directive. All directives are hard-coded and therefore, Satellite 6 is not vulnerable to this CVE. We may update this rubygem in future release.",
  "acknowledgement": "",
  "name": "CVE-2020-5217",
  "document_distribution": "",
  "details": [
    "In Secure Headers (RubyGem secure_headers), a directive injection vulnerability is present in versions before 3.8.0, 5.1.0, and 6.2.0. If user-supplied input was passed into append/override_content_security_policy_directives, a semicolon could be injected leading to directive injection. This could be used to e.g. override a script-src directive. Duplicate directives are ignored and the first one wins. The directives in secure_headers are sorted alphabetically so they pretty much all come before script-src. A previously undefined directive would receive a value even if SecureHeaders::OPT_OUT was supplied. The fixed versions will silently convert the semicolons to spaces and emit a deprecation warning when this happens. This will result in innocuous browser console messages if being exploited/accidentally used. In future releases, we will raise application errors resulting in 500s. Depending on what major version you are using, the fixed versions are 6.2.0, 5.1.0, 3.8.0.",
    "A flaw was found in rubygem-secure_headers in versions prior to 6.2.0, 5.1.0, and 3.8.0. If user-supplied input was passed into append/override_content_security_policy_directives, a semicolon could be injected leading to directive injection which could be used to override a script-src directive. The highest threat from this vulnerability is to data integrity."
  ],
  "references": [
    "https://github.com/twitter/secure_headers/security/advisories/GHSA-xq52-rv6w-397c"
  ]
}