{
  "mitigation": "If you don't want or you cannot upgrade Jinja2, you can override the `is_safe_attribute` method on the sandbox and explicitly disallow all `format` attributes on strings.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2019-05-07T00:00:00Z",
      "advisory": "RHSA-2019:1022",
      "package": "python-jinja2-0:2.7.2-3.el7_6",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Advanced Update Support",
      "release_date": "2019-12-03T00:00:00Z",
      "advisory": "RHSA-2019:4062",
      "package": "python-jinja2-0:2.7.2-3.el7_4",
      "cpe": "cpe:/o:redhat:rhel_aus:7.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Telco Extended Update Support",
      "release_date": "2019-12-03T00:00:00Z",
      "advisory": "RHSA-2019:4062",
      "package": "python-jinja2-0:2.7.2-3.el7_4",
      "cpe": "cpe:/o:redhat:rhel_tus:7.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Update Services for SAP Solutions",
      "release_date": "2019-12-03T00:00:00Z",
      "advisory": "RHSA-2019:4062",
      "package": "python-jinja2-0:2.7.2-3.el7_4",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.5 Extended Update Support",
      "release_date": "2019-11-26T00:00:00Z",
      "advisory": "RHSA-2019:3964",
      "package": "python-jinja2-0:2.7.2-3.el7_5",
      "cpe": "cpe:/o:redhat:rhel_eus:7.5"
    },
    {
      "product_name": "Red Hat Satellite 6.6 for RHEL 7",
      "release_date": "2019-10-22T00:00:00Z",
      "advisory": "RHSA-2019:3172",
      "package": "python-jinja2-0:2.10-10.el7sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2019-05-22T00:00:00Z",
      "advisory": "RHSA-2019:1260",
      "package": "python27-python-jinja2-0:2.6-12.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2019-05-22T00:00:00Z",
      "advisory": "RHSA-2019:1260",
      "package": "python27-python-jinja2-0:2.6-15.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2019-05-22T00:00:00Z",
      "advisory": "RHSA-2019:1260",
      "package": "python27-python-jinja2-0:2.6-15.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2019-05-22T00:00:00Z",
      "advisory": "RHSA-2019:1260",
      "package": "python27-python-jinja2-0:2.6-15.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2019-05-22T00:00:00Z",
      "advisory": "RHSA-2019:1260",
      "package": "python27-python-jinja2-0:2.6-15.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Will not fix",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Will not fix",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Will not fix",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "python27:2.7/python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat OpenStack Platform 14 (Rocky)",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openstack:14"
    },
    {
      "product_name": "Red Hat OpenStack Platform 15 (Stein)",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openstack:15"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Not affected",
      "package_name": "rh-python36-python-jinja2",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Will not fix",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:storage:3"
    },
    {
      "product_name": "Red Hat Update Infrastructure 3 for Cloud Providers",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:rhui:3"
    },
    {
      "product_name": "Red Hat Virtualization 4",
      "fix_state": "Not affected",
      "package_name": "rhvm-appliance",
      "cpe": "cpe:/:redhat:enterprise_linux:::hypervisor"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2016-12-29T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2016-10745 python-jinja2: Sandbox escape due to information disclosure via str.format",
    "id": "1698345",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1698345"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.0",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-138",
  "statement": "* Red Hat OpenStack Platform is not affected by this flaw. All supported versions ship python-jinja2 packages which have already been fixed.\n* Red Hat Satellite 6 will receive fixes through the underlying Red Hat Enterprise Linux, so it will not issue updates to its own affected package.\n* Red Hat Update Infrastructure is not affected because its packaged versions of python-jinja2 do not use the Sandbox feature, nor does it allow untrusted jinja2 templates.\n* Red Hat Virtualization Management Appliance includes python-jinja2 as a dependency of ovirt-engine-backend, which only uses it with controlled format strings that are not exploitable.\n* Red Hat Ceph Storage 2 and 3 are affected by this flaw as it contains the vulnerable code and will get security fixes for python-jinja2 from Red Hat Enterprise Linux 7 channel.",
  "acknowledgement": "",
  "name": "CVE-2016-10745",
  "document_distribution": "",
  "details": [
    "In Pallets Jinja before 2.8.1, str.format allows a sandbox escape.",
    "A flaw was found in Pallets Jinja prior to version 2.8.1 allows sandbox escape. Python's string format method added to strings can be used to discover potentially dangerous values including configuration values. The highest threat from this vulnerability is to data confidentiality and integrity as well as system integrity."
  ],
  "references": [
    "https://palletsprojects.com/blog/jinja-281-released/"
  ]
}