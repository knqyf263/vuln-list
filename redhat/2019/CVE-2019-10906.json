{
  "mitigation": "If you cannot upgrade python-Jinja2, you can override the `is_safe_attribute` method on the sandbox and explicitly disallow the `format_map` method on string objects.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2019-05-13T00:00:00Z",
      "advisory": "RHSA-2019:1152",
      "package": "python-jinja2-0:2.10.1-2.el8_0",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Satellite 6.6 for RHEL 7",
      "release_date": "2019-10-22T00:00:00Z",
      "advisory": "RHSA-2019:3172",
      "package": "python-jinja2-0:2.10-10.el7sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2019-06-04T00:00:00Z",
      "advisory": "RHSA-2019:1329",
      "package": "rh-python36-python-jinja2-0:2.9.6-3.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2019-06-04T00:00:00Z",
      "advisory": "RHSA-2019:1329",
      "package": "rh-python36-python-jinja2-0:2.9.6-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2019-06-04T00:00:00Z",
      "advisory": "RHSA-2019:1329",
      "package": "rh-python36-python-jinja2-0:2.9.6-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2019-06-04T00:00:00Z",
      "advisory": "RHSA-2019:1329",
      "package": "rh-python36-python-jinja2-0:2.9.6-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2019-05-16T00:00:00Z",
      "advisory": "RHSA-2019:1237",
      "package": "rh-python35-python-jinja2-0:2.8.1-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2019-06-04T00:00:00Z",
      "advisory": "RHSA-2019:1329",
      "package": "rh-python36-python-jinja2-0:2.9.6-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "python27:2.7/python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat OpenStack Platform 14 (Rocky)",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openstack:14"
    },
    {
      "product_name": "Red Hat OpenStack Platform 15 (Stein)",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openstack:15"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Not affected",
      "package_name": "python27-python-jinja2",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Update Infrastructure 3 for Cloud Providers",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:rhui:3"
    },
    {
      "product_name": "Red Hat Virtualization 4",
      "fix_state": "Not affected",
      "package_name": "rhvm-appliance",
      "cpe": "cpe:/:redhat:enterprise_linux:::hypervisor"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2019-04-06T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2019-10906 python-jinja2: str.format_map allows sandbox escape",
    "id": "1698839",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1698839"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.0",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-138",
  "statement": "Red Hat Virtualization Management Appliance includes python-jinja2 as a dependency of ovirt-engine-backend, which only uses it with controlled format strings that are not exploitable.\nRed Hat Satellite 6 will receive fixes through the underlying Red Hat Enterprise Linux, so it won't issue updates to its own affected package.\nThis issue does not affect versions of python-jinja2 as shipped with:\n* Red Hat Enterprise Linux 6, and 7 as python2 does not support str.format_map.\n* Red Hat Update Infrastructure as it does not use the Sandbox feature, nor does it allow untrusted jinja2 templates.\n* Red Hat Ceph Storage 2, 3 and Red Hat Gluster Storage 3 as python2 does not support str.format_map.\n* Red Hat OpenStack Platform 13 or 14 as python2 does not support str.format_map.",
  "acknowledgement": "",
  "name": "CVE-2019-10906",
  "document_distribution": "",
  "details": [
    "In Pallets Jinja before 2.10.1, str.format_map allows a sandbox escape.",
    "A flaw was found in Jinja. Python string formatting could allow an attacker to escape the sandbox. The highest threat from this vulnerability is to data confidentiality and integrity and system availability."
  ],
  "references": [
    "https://palletsprojects.com/blog/jinja-2-10-1-released/"
  ]
}