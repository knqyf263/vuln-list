{
  "ID": "oval:org.debian:def:20131640",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2013-1640",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 10",
        "Product": "puppet"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2013-1640",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1640"
      }
    ],
    "Description": "The (1) template and (2) inline_template functions in the master server in Puppet before 2.6.18, 2.7.x before 2.7.21, and 3.1.x before 3.1.1, and Puppet Enterprise before 1.2.7 and 2.7.x before 2.7.2 allows remote authenticated users to execute arbitrary code via a crafted catalog request.",
    "Debian": {
      "MoreInfo": "\nDSA-2643\nMultiple vulnerabilities were discovered in Puppet, a centralized\nconfiguration management system.\nAn authenticated malicious client may request its catalog from the puppet\n    master, and cause the puppet master to execute arbitrary code. The puppet\n    master must be made to invoke the \u003cq\u003etemplate\u003c/q\u003e or \u003cq\u003einline_template\u003c/q\u003e\n    functions during catalog compilation.\nAn authenticated malicious client may retrieve catalogs from the puppet\n    master that it is not authorized to access. Given a valid certificate and\n    private key, it is possible to construct an HTTP GET request that will\n    return a catalog for an arbitrary client.\nAn authenticated malicious client may execute arbitrary code on Puppet\n    agents that accept kick connections. Puppet agents are not vulnerable in\n    their default configuration. However, if the Puppet agent is configured to\n    listen for incoming connections, e.g. listen = true, and the agent's\n    auth.conf allows access to the \u003cq\u003erun\u003c/q\u003e REST endpoint, then an authenticated\n    client can construct an HTTP PUT request to execute arbitrary code on the\n    agent. This issue is made worse by the fact that puppet agents typically\n    run as root.\nA bug in Puppet allows SSL connections to be downgraded to SSLv2, which is\n    known to contain design flaw weaknesses. This affects SSL connections\n    between puppet agents and master, as well as connections that puppet agents\n    make to third party servers that accept SSLv2 connections. Note that SSLv2\n    is disabled since OpenSSL 1.0.\nAn unauthenticated malicious client may send requests to the puppet master,\n    and have the master load code in an unsafe manner. It only affects users\n    whose puppet masters are running ruby 1.9.3 and above.\nAn authenticated malicious client may execute arbitrary code on the\n    puppet master in its default configuration. Given a valid certificate and\n    private key, a client can construct an HTTP PUT request that is authorized\n    to save the client's own report, but the request will actually cause the\n    puppet master to execute arbitrary code.\nThe default auth.conf allows an authenticated node to submit a report for\n    any other node, which is a problem for compliance. It has been made more\n    restrictive by default so that a node is only allowed to save its own\n    report.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:6303",
                "Comment": "puppet DPKG is earlier than 2.7.18-3"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 10 is installed"
      }
    ]
  }
}