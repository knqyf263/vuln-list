{
  "ID": "oval:org.debian:def:20155370",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2015-5370",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 10",
        "Product": "samba"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2015-5370",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5370"
      }
    ],
    "Description": "Samba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not properly implement the DCE-RPC layer, which allows remote attackers to perform protocol-downgrade attacks, cause a denial of service (application crash or CPU consumption), or possibly execute arbitrary code on a client system via unspecified vectors.",
    "Debian": {
      "MoreInfo": "\nDSA-3548\nSeveral vulnerabilities have been discovered in Samba, a SMB/CIFS file,\nprint, and login server for Unix. The Common Vulnerabilities and\nExposures project identifies the following issues:\nJouni Knuutinen from Synopsys discovered flaws in the Samba DCE-RPC\n    code which can lead to denial of service (crashes and high cpu\n    consumption) and man-in-the-middle attacks.\nStefan Metzmacher of SerNet and the Samba Team discovered that the\n    feature negotiation of NTLMSSP does not protect against downgrade\n    attacks.\nWhen Samba is configured as domain controller, it allows remote\n    attackers to spoof the computer name of a secure channel's endpoint,\n    and obtain sensitive session information. This flaw corresponds to\n    the same vulnerability as \u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2015-0005\"\u003eCVE-2015-0005\u003c/a\u003e for Windows, discovered by\n    Alberto Solino from Core Security.\nStefan Metzmacher of SerNet and the Samba Team discovered that a\n    man-in-the-middle attacker can downgrade LDAP connections to avoid\n    integrity protection.\nStefan Metzmacher of SerNet and the Samba Team discovered that\n    man-in-the-middle attacks are possible for client triggered LDAP\n    connections and ncacn_http connections.\nStefan Metzmacher of SerNet and the Samba Team discovered that Samba\n    does not enforce required smb signing even if explicitly configured.\nStefan Metzmacher of SerNet and the Samba Team discovered that SMB\n    connections for IPC traffic are not integrity-protected.\nStefan Metzmacher of SerNet and the Samba Team discovered that a\n    man-in-the-middle attacker can intercept any DCERPC traffic between\n    a client and a server in order to impersonate the client and obtain\n    the same privileges as the authenticated user account.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:9326",
                "Comment": "samba DPKG is earlier than 2:4.3.7+dfsg-1"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 10 is installed"
      }
    ]
  }
}