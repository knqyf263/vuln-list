{
  "ID": "oval:org.debian:def:201711103",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2017-11103",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 10",
        "Product": "heimdal"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2017-11103",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11103"
      }
    ],
    "Description": "Heimdal before 7.4 allows remote attackers to impersonate services with Orpheus' Lyre attacks because it obtains service-principal names in a way that violates the Kerberos 5 protocol specification. In _krb5_extract_ticket() the KDC-REP service name must be obtained from the encrypted version stored in 'enc_part' instead of the unencrypted version stored in 'ticket'. Use of the unencrypted version provides an opportunity for successful server impersonation and other attacks. NOTE: this CVE is only for Heimdal and other products that embed Heimdal code; it does not apply to other instances in which this part of the Kerberos 5 protocol specification is violated.",
    "Debian": {
      "MoreInfo": "\nDSA-3909\nJeffrey Altman, Viktor Duchovni and Nico Williams identified a mutual\nauthentication bypass vulnerability in samba, the SMB/CIFS file, print, and\nlogin server. Also known as Orpheus' Lyre, this vulnerability is located in\nSamba Kerberos Key Distribution Center (KDC-REP) component and could be used by\nan attacker on the network path to impersonate a server.\nMore details can be found on the vulnerability website\n(\u003ca href=\"https://orpheus-lyre.info/\"\u003ehttps://orpheus-lyre.info/\u003c/a\u003e)\nand on the Samba project website (\u003ca href=\"https://www.samba.org/samba/security/CVE-2017-11103.html\"\u003e\nhttps://www.samba.org/samba/security/CVE-2017-11103.html\u003c/a\u003e)\nDSA-3912\nJeffrey Altman, Viktor Dukhovni, and Nicolas Williams reported that\nHeimdal, an implementation of Kerberos 5 that aims to be compatible with\nMIT Kerberos, trusts metadata taken from the unauthenticated plaintext\n(Ticket), rather than the authenticated and encrypted KDC response. A\nman-in-the-middle attacker can use this flaw to impersonate services to\nthe client.\nSee \u003ca href=\"https://orpheus-lyre.info/\"\u003ehttps://orpheus-lyre.info/\u003c/a\u003e for details.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:12036",
                "Comment": "heimdal DPKG is earlier than 7.4.0.dfsg.1-1"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 10 is installed"
      }
    ]
  }
}