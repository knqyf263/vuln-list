{
  "ID": "oval:org.debian:def:20175715",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2017-5715",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 9",
        "Product": "linux"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2017-5715",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5715"
      }
    ],
    "Description": "Systems with microprocessors utilizing speculative execution and indirect branch prediction may allow unauthorized disclosure of information to an attacker with local user access via a side-channel analysis.",
    "Debian": {
      "MoreInfo": "\nDSA-4213\nSeveral vulnerabilities were discovered in qemu, a fast processor\nemulator.\nTuomas Tynkkynen discovered an information leak in 9pfs.\nEric Blake discovered that the NBD server insufficiently restricts\n    large option requests, resulting in denial of service.\nDaniel Berrange discovered that the integrated VNC server\n    insufficiently restricted memory allocation, which could result in\n    denial of service.\nA memory leak in websockets support may result in denial of service.\nGuoxiang Niu discovered an OOB write in the emulated Cirrus graphics\n    adaptor which could result in denial of service.\nCyrille Chatras discovered an information leak in PS/2 mouse and\n    keyboard emulation which could be exploited during instance\n    migration.\nDengzhan Heyuandong Bijunhua and Liweichao discovered that an\n    implementation error in the virtio vring implementation could result\n    in denial of service.\nEric Blake discovered an integer overflow in an internally used\n    macro which could result in denial of service.\nJiang Xin and Lin ZheCheng discovered an OOB memory access in the\n    emulated VGA adaptor which could result in denial of service.\nCyrille Chatras discovered that an OOB memory write when using\n    multiboot could result in the execution of arbitrary code.\nThis update also backports a number of mitigations against the Spectre\nv2 vulnerability affecting modern CPUs \n(\u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2017-5715\"\u003e\\\nCVE-2017-5715\u003c/a\u003e).  For additional information please refer to\n\u003ca href=\"https://www.qemu.org/2018/01/04/spectre/\"\u003e\\\nhttps://www.qemu.org/2018/01/04/spectre/\u003c/a\u003e\nDSA-4120\nSeveral vulnerabilities have been discovered in the Linux kernel that may\nlead to a privilege escalation, denial of service or information leaks.\nMultiple researchers have discovered a vulnerability in various\n    processors supporting speculative execution, enabling an attacker\n    controlling an unprivileged process to read memory from arbitrary\n    addresses, including from the kernel and all other processes running on\n    the system.\nThis specific attack has been named Spectre variant 2 (branch target\n    injection) and is mitigated in the Linux kernel for the Intel x86-64\n    architecture by using the \u003cq\u003eretpoline\u003c/q\u003e compiler feature which allows\n    indirect branches to be isolated from speculative execution.\nMultiple researchers have discovered a vulnerability in Intel\n    processors, enabling an attacker controlling an unprivileged process to\n    read memory from arbitrary addresses, including from the kernel and all\n    other processes running on the system.\nThis specific attack has been named Meltdown and is addressed in the\n    Linux kernel on the powerpc/ppc64el architectures by flushing the L1\n    data cache on exit from kernel mode to user mode (or from hypervisor to\n    kernel).\nThis works on Power7, Power8 and Power9 processors.\nA bug in the 32-bit compatibility layer of the v4l2 IOCTL handling code\n    has been found. Memory protections ensuring user-provided buffers always\n    point to userland memory were disabled, allowing destination address to\n    be in kernel space. This bug could be exploited by an attacker to\n    overwrite kernel memory from an unprivileged userland process, leading\n    to privilege escalation.\nAn information leak has been found in the Linux kernel. The\n    acpi_smbus_hc_add() prints a kernel address in the kernel log at every\n    boot, which could be used by an attacker on the system to defeat kernel\n    ASLR.\nAdditionnaly to those vulnerability, some mitigations for \u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2017-5753\"\u003eCVE-2017-5753\u003c/a\u003e are\nincluded in this release.\nMultiple researchers have discovered a vulnerability in various\n    processors supporting speculative execution, enabling an attacker\n    controlling an unprivileged process to read memory from arbitrary\n    addresses, including from the kernel and all other processes running on\n    the system.\nThis specific attack has been named Spectre variant 1 (bounds-check\n    bypass) and is mitigated in the Linux kernel architecture by identifying\n    vulnerable code sections (array bounds checking followed by array\n    access) and replacing the array access with the speculation-safe\n    array_index_nospec() function.\nMore use sites will be added over time.\nDSA-4188\nSeveral vulnerabilities have been discovered in the Linux kernel that\nmay lead to a privilege escalation, denial of service or information\nleaks.\nMultiple researchers have discovered a vulnerability in various\n    processors supporting speculative execution, enabling an attacker\n    controlling an unprivileged process to read memory from arbitrary\n    addresses, including from the kernel and all other processes\n    running on the system.\nThis specific attack has been named Spectre variant 2 (branch\n    target injection) and is mitigated for the x86 architecture (amd64\n    and i386) by using the \u003cq\u003eretpoline\u003c/q\u003e compiler feature which allows\n    indirect branches to be isolated from speculative execution.\nMultiple researchers have discovered a vulnerability in various\n    processors supporting speculative execution, enabling an attacker\n    controlling an unprivileged process to read memory from arbitrary\n    addresses, including from the kernel and all other processes\n    running on the system.\nThis specific attack has been named Spectre variant 1\n    (bounds-check bypass) and is mitigated by identifying vulnerable\n    code sections (array bounds checking followed by array access) and\n    replacing the array access with the speculation-safe\n    array_index_nospec() function.\nMore use sites will be added over time.\nTuba Yavuz reported a use-after-free flaw in the USBTV007\n    audio-video grabber driver. A local user could use this for denial\n    of service by triggering failure of audio registration.\nYunlei He reported that the f2fs implementation does not properly\n    handle extent trees, allowing a local user to cause a denial of\n    service via an application with multiple threads.\nAlex Chen reported that the OCFS2 filesystem failed to hold a\n    necessary lock during nodemanager sysfs file operations,\n    potentially leading to a null pointer dereference.  A local user\n    could use this for denial of service.\nJun He reported a use-after-free flaw in the Hisilicon HNS ethernet\n    driver. A local user could use this for denial of service.\nIt was reported that the Hisilicon Network Subsystem (HNS) driver\n    implementation does not properly handle ethtool private flags. A\n    local user could use this for denial of service or possibly have\n    other impact.\nAlex Chen reported that the OCFS2 filesystem omits the use of a\n    semaphore and consequently has a race condition for access to the\n    extent tree during read operations in DIRECT mode. A local user\n    could use this for denial of service.\nYunlei He reported that the f2fs implementation does not properly\n    initialise its state if the \u003cq\u003enoflush_merge\u003c/q\u003e mount option is used.\n    A local user with access to a filesystem mounted with this option\n    could use this to cause a denial of service.\nIt was reported that the f2fs implementation is prone to an infinite\n    loop caused by an integer overflow in the __get_data_block()\n    function. A local user can use this for denial of service via\n    crafted use of the open and fallocate system calls with an\n    FS_IOC_FIEMAP ioctl.\nThe syzkaller tool found a NULL pointer dereference flaw in the\n    netfilter subsystem when handling certain malformed iptables\n    rulesets. A local user with the CAP_NET_RAW or CAP_NET_ADMIN\n    capability (in any user namespace) could use this to cause a denial\n    of service. Debian disables unprivileged user namespaces by default.\nDan Aloni reported to Red Hat that the CIFS client implementation\n    would dereference a null pointer if the server sent an invalid\n    response during NTLMSSP setup negotiation.  This could be used\n    by a malicious server for denial of service.\nThe syzkaller tool found that the 32-bit compatibility layer of\n    ebtables did not sufficiently validate offset values. On a 64-bit\n    kernel, a local user with the CAP_NET_ADMIN capability (in any user\n    namespace) could use this to overwrite kernel memory, possibly\n    leading to privilege escalation. Debian disables unprivileged user\n    namespaces by default.\nWen Xu reported that a crafted ext4 filesystem image would\n    trigger a null dereference when mounted.  A local user able\n    to mount arbitrary filesystems could use this for denial of\n    service.\nWen Xu reported that a crafted ext4 filesystem image could trigger\n    an out-of-bounds read in the ext4_valid_block_bitmap() function. A\n    local user able to mount arbitrary filesystems could use this for\n    denial of service.\nJann Horn reported that crng_ready() does not properly handle the\n    crng_init variable states and the RNG could be treated as\n    cryptographically safe too early after system boot.\nAlexey Kodanev reported that the SCTP protocol did not range-check\n    the length of chunks to be created.  A local or remote user could\n    use this to cause a denial of service.\nHou Tao discovered a double-free flaw in the blkcg_init_queue()\n    function in block/blk-cgroup.c. A local user could use this to cause\n    a denial of service or have other impact.\nFan LongFei reported a race condition in the ALSA (sound)\n    sequencer core, between write and ioctl operations.  This could\n    lead to an out-of-bounds access or use-after-free.  A local user\n    with access to a sequencer device could use this for denial of\n    service or possibly for privilege escalation.\nNic Losby reported that the hugetlbfs filesystem's mmap operation\n    did not properly range-check the file offset.  A local user with\n    access to files on a hugetlbfs filesystem could use this to cause\n    a denial of service.\nJason Yan reported a memory leak in the SAS (Serial-Attached\n    SCSI) subsystem.  A local user on a system with SAS devices\n    could use this to cause a denial of service.\nSeunghun Han reported a race condition in the x86 MCE\n    (Machine Check Exception) driver.  This is unlikely to have\n    any security impact.\nA memory leak flaw was found in the hwsim_new_radio_nl() function in\n    the simulated radio testing tool driver for mac80211, allowing a\n    local user to cause a denial of service.\nEyal Itkin reported that the udl (DisplayLink) driver's mmap\n    operation did not properly range-check the file offset.  A local\n    user with access to a udl framebuffer device could exploit this to\n    overwrite kernel memory, leading to privilege escalation.\nDr Silvio Cesare of InfoSect reported that the ncpfs client\n    implementation did not validate reply lengths from the server.  An\n    ncpfs server could use this to cause a denial of service or\n    remote code execution in the client.\nWen Xu reported a NULL pointer dereference flaw in the\n    xfs_bmapi_write() function triggered when mounting and operating a\n    crafted xfs filesystem image. A local user able to mount arbitrary\n    filesystems could use this for denial of service.\nAndy Lutomirski discovered that the ptrace subsystem did not\n    sufficiently validate hardware breakpoint settings.  Local users\n    can use this to cause a denial of service, or possibly for\n    privilege escalation, on x86 (amd64 and i386) and possibly other\n    architectures.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:15534",
                "Comment": "linux DPKG is earlier than 4.9.88-1"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 9 is installed"
      }
    ]
  }
}