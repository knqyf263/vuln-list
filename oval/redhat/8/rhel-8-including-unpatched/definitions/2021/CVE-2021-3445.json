{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213445",
  "Version": "633",
  "Metadata": {
    "Title": "CVE-2021-3445 libdnf: libdnf does its own signature verification, but this can be tricked by placing a signature in the main header (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3445",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3445"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in libdnf's signature verification functionality. This flaw allows an attacker to achieve code execution if they can alter the header information of an RPM package and then trick a user or system into installing it. The highest risk of this vulnerability is to confidentiality, integrity, as well as system availability.\n            STATEMENT: The exploitation of this flaw requires RPM's package verification level to be set to \"digest\" or \"none\". In addition, to exploit this flaw, an attacker must either compromise an RPM repository or convince an administrator to install an untrusted RPM.  It is strongly recommended to only use RPMs from trusted repositories.\n            MITIGATION: A mitigation for this flaw is to set %_pkgverify_level all` or `%_pkgverify_level signature` in `/etc/rpm/macros`.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2021-03-16"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3445",
          "Cvss3": "6.4/CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-347",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3445",
          "Public": "20210316:1702"
        }
      ]
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137488004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137488003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libdnf-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213445001"
                  },
                  {
                    "Comment": "libdnf-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213445002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-libdnf is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213445003"
                  },
                  {
                    "Comment": "python3-libdnf is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213445004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libdnf is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213445005"
                  },
                  {
                    "Comment": "libdnf is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213445006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-hawkey is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213445007"
                  },
                  {
                    "Comment": "python3-hawkey is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213445008"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}