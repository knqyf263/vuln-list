{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202013936",
  "Version": "633",
  "Metadata": {
    "Title": "CVE-2020-13936 velocity: arbitrary code execution when attacker is able to modify templates (low)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-13936",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-13936"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in velocity. An attacker, able to modify Velocity templates, may execute arbitrary Java code or run arbitrary system commands with the same privileges as the account running the Servlet container. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.\n            STATEMENT: OpenShift Container Platform (OCP) openshift-logging/elasticsearch6-rhel8 container does contain a vulnerable version of velocity. The references to the library only occur in the x-pack component which is an enterprise-only feature of Elasticsearch - hence it has been marked as wontfix as this time and may be fixed in a future release. Additionally the hive container only references velocity in the testutils of the code but the code still exists in the container, as such it has been given a Moderate impact.\n\n* Velocity as shipped with Red Hat Enterprise Linux 6 is not affected because it does not contain the vulnerable code.\n\n* Velocity as shipped with Red Hat Enterprise Linux 7 contains a vulnerable version, but it is used as a dependency for IdM/ipa, which does not use the vulnerable functionality. It has been marked as Moderate for this reason.\n\n* Although velocity shipped in Red Hat Enterprise Linux 8's pki-deps:10.6 for IdM/ipa is a vulnerable version, the vulnerable code is not used by pki. It has been marked as Low for this reason.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Low",
      "Issued": {},
      "Updated": {
        "Date": "2021-03-19"
      },
      "Cves": [
        {
          "CveID": "CVE-2020-13936",
          "Cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "(CWE-77|CWE-94)",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2020-13936",
          "Public": "20210309"
        }
      ]
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137488004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137488003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module javapackages-tools:201801 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:201910086005"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936001"
                          },
                          {
                            "Comment": "velocity is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-javadoc is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936003"
                          },
                          {
                            "Comment": "velocity-javadoc is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-manual is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936005"
                          },
                          {
                            "Comment": "velocity-manual is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936006"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-demo is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936007"
                          },
                          {
                            "Comment": "velocity-demo is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936008"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module javapackages-tools:201902 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202013936010"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936001"
                          },
                          {
                            "Comment": "velocity is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-javadoc is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936003"
                          },
                          {
                            "Comment": "velocity-javadoc is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-manual is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936005"
                          },
                          {
                            "Comment": "velocity-manual is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936006"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-demo is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936007"
                          },
                          {
                            "Comment": "velocity-demo is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936008"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module pki-deps:10.6 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:20190199005"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936001"
                          },
                          {
                            "Comment": "velocity is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-javadoc is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936003"
                          },
                          {
                            "Comment": "velocity-javadoc is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-manual is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936005"
                          },
                          {
                            "Comment": "velocity-manual is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936006"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "velocity-demo is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202013936007"
                          },
                          {
                            "Comment": "velocity-demo is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202013936008"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}