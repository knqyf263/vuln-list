{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:201910161",
  "Version": "633",
  "Metadata": {
    "Title": "CVE-2019-10161 libvirt: arbitrary file read/exec via virDomainSaveImageGetXMLDesc API (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2019-10161",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2019-10161"
      }
    ],
    "Description": "DOCUMENTATION: It was discovered that libvirtd would permit read-only clients to use the virDomainSaveImageGetXMLDesc() API, specifying an arbitrary path which would be accessed with the permissions of the libvirtd process. An attacker with access to the libvirtd socket could use this to probe the existence of arbitrary files, cause denial of service or cause libvirtd to execute arbitrary programs.\n            STATEMENT: * This vulnerability requires access to the libvirt socket, normally in /var/run/libvirt/libvirt_sock_ro.  Typically in hypervisor environments, local user accounts are not supported so no untrusted users should be able to access this socket.\n* Red Hat Gluster Storage 3 is not affected by this vulnerability as libvirtd daemon is not shipped in Gluster.\n* On Red Hat Enterprise Linux 6, the impact of this vulnerability is limited to denial of service or disclosing the existence of arbitrary files.  Privilege escalation is not possible.  For RHEL6, this CVE is rated as Moderate severity with 7.3/CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:H\n            MITIGATION: The Unix permissions of libvirt's read-only socket can be made more restrictive than the default (0777) by editing `/etc/libvirt/libvirtd.conf`.  The settings `unix_sock_group = libvirt` and `unix_sock_ro_perms = 0770` will restrict access to only members of `libvirt`, who already have management access to virtual machines.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2021-02-16"
      },
      "Cves": [
        {
          "CveID": "CVE-2019-10161",
          "Cvss3": "8.8/CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "Cwe": "CWE-284",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2019-10161",
          "Public": "20190620:1200"
        }
      ]
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20120860004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20120860003"
          },
          {
            "Comment": "redhat-virtualization-host-image-update is installed",
            "TestRef": "oval:com.redhat.cve:tst:20181000805003"
          },
          {
            "Comment": "redhat-virtualization-host-image-update is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:20181000805004"
          }
        ]
      }
    ]
  }
}