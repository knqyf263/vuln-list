{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213156",
  "Version": "635",
  "Metadata": {
    "Title": "CVE-2021-3156 sudo: Heap buffer overflow in argument parsing (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3156",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3156"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in sudo. A heap-based buffer overflow was found in the way sudo parses command line arguments. This flaw is exploitable by any local user who can execute the sudo command (by default, any local user can execute sudo) without authentication. Successful exploitation of this flaw could lead to privilege escalation. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.\n            STATEMENT: This flaw does not affect the versions of sudo shipped with Red Hat Enterprise Linux 5, because the vulnerable code was not present in these versions.\n            MITIGATION: Red Hat Product Security strongly recommends customers to update to fixed sudo packages once they are available. For customers who cannot update immediately, the following interim partial mitigation using systemtap is suggested:\n\n1. Install required systemtap packages and dependencies: \n```\nsystemtap yum-utils kernel-devel-\"$(uname -r)\"\n```\n\nThen for RHEL 7 install kernel debuginfo, using:\n```\ndebuginfo-install -y kernel-\"$(uname -r)\" \n```\nThen for RHEL 8 \u0026 6 install sudo debuginfo, using:\n```\ndebuginfo-install sudo\n```\n \n2. Create the following systemtap script: (call the file as sudoedit-block.stap)\n```\nprobe process(\"/usr/bin/sudo\").function(\"main\")  {\n        command = cmdline_args(0,0,\"\");\n        if (isinstr(command, \"edit\")) {\n                raise(9);\n        }\n}\n```\n3. Install the script using the following command: (using root)\n```\n# nohup stap -g sudoedit-block.stap \u0026\n```\n(This should output the PID number of the systemtap script)\n\nThis script will cause the vulnerable sudoedit binary to stop working. The sudo command will still work as usual.\nThe above change does not persist across reboots and must be applied after each reboot.\n\nPlease consult How to make a systemtap kernel module load persistently across reboots? (https://access.redhat.com/solutions/5752521) to learn how to\nturn this into a service managed by initd. \n\n4. Once the new fixed packages are installed, the systemtap script can be removed by killing the systemtap process.  For example, by using:\n```\n# kill -s SIGTERM 7590\n```\n(where 7590 is the PID of the systemtap process)",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2021-02-25"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3156",
          "Cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-122",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3156",
          "Public": "20210126:1800"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:6",
        "cpe:/a:redhat:rhel_extras_hpn:6",
        "cpe:/a:redhat:rhel_extras_oracle_java:6",
        "cpe:/a:redhat:rhel_extras_sap:6",
        "cpe:/a:redhat:rhel_extras_sap_hana:6",
        "cpe:/o:redhat:enterprise_linux:6",
        "cpe:/o:redhat:enterprise_linux:6::client",
        "cpe:/o:redhat:enterprise_linux:6::computenode",
        "cpe:/o:redhat:enterprise_linux:6::server",
        "cpe:/o:redhat:enterprise_linux:6::workstation",
        "cpe:/o:redhat:rhel_eus:6.0"
      ]
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20022439070"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 6 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20022439069"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "sudo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20155602001"
                  },
                  {
                    "Comment": "sudo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20155602002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "sudo-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20155602003"
                  },
                  {
                    "Comment": "sudo-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20155602004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}