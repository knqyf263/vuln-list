{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202131607",
  "Version": "635",
  "Metadata": {
    "Title": "CVE-2021-31607 salt: Command injection in the snapper module (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-31607",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-31607"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in salt. A command injection vulnerability was found in the snapper module to allow for local privilege escalation on a minion. This attack requires that a file be created with a pathname that is backed up by snapper, with the master calling the snapper.diff function. Snapper.diff executes popen unsafely. The greatest threat to the system is to confidentiality, availability, and integrity.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2021-05-05"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-31607",
          "Cvss3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-77",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-31607",
          "Public": "20210423"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:ceph_storage:2",
        "cpe:/a:redhat:ceph_storage:2::el7"
      ]
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137459004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137459003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "salt is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20169639001"
                  },
                  {
                    "Comment": "salt is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20169639002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "salt-minion is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20169639003"
                  },
                  {
                    "Comment": "salt-minion is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20169639004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}